name: CoinWatcher CI # Name of the pipeline

# When should this robot run?
on:
  push:
    branches: [ "main" ] # Run when you push to main
  pull_request:
    branches: [ "main" ] # Run when someone tries to merge into main

# What jobs should the robot do?
jobs:
  build-android-desktop:
    name: Build Android & Desktop
    runs-on: ubuntu-latest # Use a virtual Linux machine (Free & Fast)

    steps:
      # Step 1: Download your code from the repo
      - name: Checkout code
        uses: actions/checkout@v4

      # Step 2: Install Java 17 (Required for Kotlin/Android)
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      # Step 3: Setup Gradle (The build tool)
      - name: Setup Gradle
        uses: gradle/actions/setup-gradle@v4

      # Step 4: Grant permission to execute the build script
      - name: Grant execute permission for gradlew
        run: chmod +x gradlew

      # Step 5: Actually Build the App
      # This runs the same command you run in terminal.
      # It checks compilation for Android and Desktop (JVM).
      - name: Build with Gradle
        run: ./gradlew :composeApp:assembleDebug :composeApp:jvmMainClasses

      # Step 6: Run Tests (Optional for now, but good practice)
      # - name: Run Unit Tests
      #   run: ./gradlew test